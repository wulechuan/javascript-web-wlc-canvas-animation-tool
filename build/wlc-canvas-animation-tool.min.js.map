{"version":3,"sources":["wlc-canvas-animation-tool.js"],"names":["createWhatWeWant","window","wlcCanvasAnimationController","canvas","a","b","_init","canvasContextType","initOptions","regExpCanvasContextType","data","privateData","thisInstance","drawFrame","match","trim","toLowerCase","canvasContext","elements","getContext","state","bgColor","settings","defaultBgColor","config","call","options","_inputTemp","isValidColor","parseFloat","timeOffset","isNaN","drawingFramesCountLimitation","NaN","parseInt","getData","key","copy","getCanvas","clearCanvas","shouldStopAnimation","clearRect","width","height","stopAnimation","shouldClearCanvas","privateState","animationIsStopped","animationIsPaused","startAnimation","shouldClearCanvasBeforeDrawing","animationStartWallTime","Date","getTime","drawnFramesCount","boundMethods","drawNextFrame","pauseAnimation","resumeAnimation","drawOneFrame","localTimeInSeconds","_drawOneFrameOnTime","drawOneFrameOnTimeViaMethod","_drawOrClearBg","_drawNextFrame","console","info","log","requestAnimationFrame","ctx","fillStyle","fillRect","Node","document","getElementById","isJQueryWrappedObjectOrAlike","tagName","canvasContainer","createElement","appendChild","error","this","Object","defineProperty","enumerable","get","set","newValue","bind","drawOneFrameOnTime","object","isJQueryWrappedObject","getPrototypeOf","jquery","color"],"mappings":"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","file":"wlc-canvas-animation-tool.min.js","sourcesContent":["(function (createWhatWeWant) {\n\twindow.wlcCanvasAnimationController = createWhatWeWant();\n})(function createWhatWeWant() {\n\t/**\n\t * Constructor for create an instant object that helps making canvas animations.\n\t * \n\t * @constructor\n\t * @author 吴乐川 <wulechuan@live.com>\n\t * @argument {!(string|Node|jQueryObject)} canvas the canvas element,\n\t * \tor the container object that is NOT a canvas element,\n\t *  under which a new canvas element will be created automatically.\n\t * \n\t * @argument {?(string|function|object)} a Multi-purpose.\n\t * \t\tIf 1 argument is provided:\n\t * \t\t>\tIf it's a string, it's treated as the canvas context type;\n\t * \t\t\tIf it's an object, it's treated as the \"options\" objet;\n\t * \t\t\tIf it's a function, it's treated as the \"drawFrame\" method.\n\t * \n\t * \t\tIf 2 arguments are provided:\n\t * \t\t>\tThe one that is a string is treated as the canvas context type;\n\t * \t\t\tThe one that is an object is treated as the \"options\" objet;\n\t * \t\t\tThe one that is a function is treated as the \"drawFrame\" method;\n\t * \n\t * \t\t\tTf both are of the same type, e. g. both are functions,\n\t * \t\t\tan error will be logged and construction will fail.\n\t * \n\t * \t\t\tIf a function is provided, while the other argument being an object,\n\t * \t\t\tand contains a function property named \"drawFrame\",\n\t * \t\t\tthen the property of the object argument is taken,\n\t * \t\t\tthe function argument is ignored.\n\t * \n\t * @argument {?(string|function|object)} b Multi-purpose.\n\t * >\tSee argument a.\n\t * \n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\tfunction myFancyDrawingFunction () { ... }\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t'3d',\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t */\n\n\tfunction wlcCanvasAnimationController(canvas, a, b) {\n\t\tvar settings = {\n\t\t\tdefaultBgColor: ''\n\t\t};\n\n\t\tvar privateData = {\n\t\t\telements: {\n\t\t\t\tcanvas: null\n\t\t\t},\n\t\t\tdata: {\n\t\t\t\tcanvasContextType: '2d',\n\t\t\t\tcanvasContext: null,\n\t\t\t},\n\t\t\tstate: {\n\t\t\t\tanimationStartWallTime: NaN,\n\t\t\t\tdrawnFramesCount: 0,\n\t\t\t\tanimationIsStopped: true,\n\t\t\t\tanimationIsPaused: false\n\t\t\t}\n\t\t};\n\n\t\tvar state = {\n\t\t\tdrawingFramesCountLimitation: NaN, // In case we need to draw like 1000 frames and then stop there for ever\n\t\t\ttimeOffset: 0 // in milliseconds\n\t\t};\n\n\n\n\n\n\n\t\tif (!(canvas instanceof Node)) {\n\t\t\tif (typeof canvas === 'string') {\n\t\t\t\tcanvas = document.getElementById(canvas);\n\t\t\t} else if (wlcCanvasAnimationController.isJQueryWrappedObjectOrAlike(canvas)) {\n\t\t\t\tcanvas = canvas[0];\n\t\t\t} else {\n\t\t\t\tcanvas = null;\n\t\t\t}\n\t\t}\n\n\t\tif (!canvas) {\n\t\t\tconsole && console.error('Invalid canvas provided.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!canvas.tagName.match(/canvas/i)) {\n\t\t\tvar canvasContainer = canvas;\n\t\t\tcanvas = document.createElement('canvas');\n\t\t\tcanvasContainer.appendChild(canvas);\n\t\t}\n\n\t\tprivateData.elements.canvas = canvas;\n\n\t\tif ((typeof a === 'object' && typeof b === 'object' && a && b)\n\t\t\t|| (typeof a === 'string' && typeof b === 'string')\n\t\t\t|| (typeof a === 'function' && typeof b === 'function')\n\t\t) {\n\t\t\tconsole && console.error('Invalid arguments.');\n\t\t\treturn;\n\t\t}\n\n\n\n\t\tvar requestAnimationFrame = window.requestAnimationFrame;\n\t\tvar thisInstance = this;\n\n\t\tObject.defineProperty(state, 'animationIsStopped', {\n\t\t\t// configurable: false,\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn privateData.state.animationIsStopped;\n\t\t\t},\n\t\t\tset: function (newValue) {\n\t\t\t\tif (newValue) {\n\t\t\t\t\tthisInstance.stopAnimation();\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.startAnimation();\n\t\t\t\t}\n\n\t\t\t\treturn privateData.state.animationIsStopped;\n\t\t\t}\n\t\t});\n\n\t\tObject.defineProperty(state, 'animationIsPaused', {\n\t\t\t// configurable: false,\n\t\t\tenumerable: true,\n\t\t\tget: function () {\n\t\t\t\treturn privateData.state.animationIsPaused;\n\t\t\t},\n\t\t\tset: function (newValue) {\n\t\t\t\tif (newValue) {\n\t\t\t\t\tthisInstance.pauseAnimation();\n\t\t\t\t} else {\n\t\t\t\t\tthisInstance.resumeAnimation();\n\t\t\t\t}\n\n\t\t\t\treturn privateData.state.animationIsPaused;\n\t\t\t}\n\t\t});\n\n\t\t_init.call(thisInstance, a, b);\n\n\n\t\tthisInstance.state = state;\n\t\tthisInstance.config = config.bind(thisInstance);\n\t\tthisInstance.getData = getData.bind(thisInstance);\n\t\tthisInstance.getCanvas = getCanvas.bind(thisInstance);\n\t\tthisInstance.clearCanvas = clearCanvas.bind(thisInstance);\n\n\t\tthisInstance.stopAnimation = stopAnimation.bind(thisInstance);\n\t\tthisInstance.startAnimation = startAnimation.bind(thisInstance);\n\t\tthisInstance.pauseAnimation = pauseAnimation.bind(thisInstance);\n\t\tthisInstance.resumeAnimation = resumeAnimation.bind(thisInstance);\n\n\t\tthisInstance.drawOneFrame = drawOneFrame.bind(thisInstance);\n\t\tthisInstance.drawOneFrameOnTime = drawOneFrameOnTimeViaMethod.bind(thisInstance);\n\n\t\tvar boundMethods = {\n\t\t\tdrawNextFrame: _drawNextFrame.bind(this)\n\t\t};\n\n\n\t\tif (!privateData.state.animationIsStopped) {\n\t\t\tthisInstance.startAnimation();\n\t\t}\n\n\n\n\n\n\n\t\tfunction _init(a, b) {\n\t\t\tvar canvasContextType, initOptions;\n\t\t\tvar regExpCanvasContextType = /\\s*(2d|3d|webgl)\\s*/i;\n\t\t\tvar data = privateData.data;\n\n\t\t\tif (typeof a === 'object' && a) {\n\t\t\t\tinitOptions = a;\n\n\t\t\t\tif (typeof b === 'function') {\n\t\t\t\t\tthisInstance.drawFrame = b;\n\t\t\t\t} else if (typeof b === 'string' && b.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = b.trim().toLowerCase();\n\t\t\t\t\tdata.canvasContextType = canvasContextType;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof b === 'object' && b) {\n\t\t\t\tinitOptions = b;\n\n\t\t\t\tif (typeof a === 'function') {\n\t\t\t\t\tthisInstance.drawFrame = a;\n\t\t\t\t} else if (typeof a === 'string' && a.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = a.trim().toLowerCase();\n\t\t\t\t\tdata.canvasContextType = canvasContextType;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tdata.canvasContext = privateData.elements.canvas.getContext(data.canvasContextType);\n\t\t\tstate.bgColor = settings.defaultBgColor;\n\n\t\t\tconfig.call(thisInstance, initOptions);\n\n\t\t}\n\n\t\tfunction config(options) {\n\t\t\toptions = options || {};\n\t\t\tvar _inputTemp;\n\n\n\n\t\t\t_inputTemp = options.bgColor;\n\t\t\tif (wlcCanvasAnimationController.isValidColor(_inputTemp)) {\n\t\t\t\tstate.bgColor = _inputTemp;\n\t\t\t}\n\n\n\n\t\t\t_inputTemp = parseFloat(options.timeOffset);\n\t\t\tif (!isNaN(_inputTemp)) {\n\t\t\t\tstate.timeOffset = _inputTemp;\n\t\t\t}\n\n\n\n\t\t\t_inputTemp = options.drawingFramesCountLimitation;\n\t\t\tif (isNaN(_inputTemp)) {\n\t\t\t\tstate.drawingFramesCountLimitation = NaN;\n\t\t\t} else {\n\t\t\t\t_inputTemp = parseInt(options.drawingFramesCountLimitation);\n\t\t\t\tif (!isNaN(_inputTemp)) {\n\t\t\t\t\tstate.drawingFramesCountLimitation = _inputTemp;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t_inputTemp = options.drawFrame;\n\t\t\tif (typeof _inputTemp === 'function') {\n\t\t\t\tthisInstance.drawFrame = options.drawFrame;\n\t\t\t}\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction getData() {\n\t\t\tvar copy = {\n\t\t\t\telements: {\n\t\t\t\t\tcanvas: privateData.elements.canvas\n\t\t\t\t},\n\t\t\t\tdata: {},\n\t\t\t\tstate: {}\n\t\t\t};\n\n\t\t\tvar key;\n\n\t\t\tfor (key in privateData.data) {\n\t\t\t\tcopy.data[key] = privateData.data[key];\n\t\t\t}\n\n\t\t\tfor (key in privateData.state) {\n\t\t\t\tcopy.state[key] = privateData.state[key];\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t}\n\n\t\tfunction getCanvas() {\n\t\t\treturn privateData.elements.canvas;\n\t\t}\n\n\t\tfunction clearCanvas(shouldStopAnimation) {\n\t\t\tvar canvas = privateData.elements.canvas;\n\t\t\tprivateData.data.canvasContext.clearRect(0, 0, canvas.width, canvas.height);\n\n\t\t\tif (shouldStopAnimation) thisInstance.stopAnimation();\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction stopAnimation(shouldClearCanvas) {\n\t\t\tvar privateState = privateData.state;\n\t\t\tprivateState.animationIsStopped = true;\n\t\t\tprivateState.animationIsPaused = false;\n\n\t\t\tif (shouldClearCanvas) thisInstance.clearCanvas();\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction startAnimation(shouldClearCanvasBeforeDrawing) {\n\t\t\tvar privateState = privateData.state;\n\t\t\tif (!privateState.animationIsPaused && !privateState.animationIsStopped) {\n\t\t\t\treturn thisInstance;\n\t\t\t}\n\n\t\t\tprivateState.animationIsPaused = false;\n\t\t\tprivateState.animationIsStopped = false;\n\n\t\t\tprivateState.animationStartWallTime = new Date().getTime() - state.timeOffset;\n\t\t\tprivateState.drawnFramesCount = 0;\n\n\t\t\tboundMethods.drawNextFrame(shouldClearCanvasBeforeDrawing);\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction pauseAnimation() {\n\t\t\tvar privateState = privateData.state;\n\t\t\tif (privateState.animationIsStopped) return;\n\n\t\t\tprivateState.animationIsPaused = true;\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction resumeAnimation() {\n\t\t\tvar privateState = privateData.state;\n\t\t\tif (privateState.animationIsStopped || !privateState.animationIsPaused) return;\n\n\t\t\tprivateState.animationIsPaused = false;\n\t\t\tboundMethods.drawNextFrame();\n\n\t\t\treturn thisInstance; // for chaining invocations\n\t\t}\n\n\t\tfunction drawOneFrame() {\n\t\t\tvar localTimeInSeconds = (new Date().getTime() - privateData.state.animationStartWallTime) / 1000;\n\t\t\treturn _drawOneFrameOnTime.call(thisInstance, localTimeInSeconds);\n\t\t}\n\n\t\tfunction drawOneFrameOnTimeViaMethod(localTimeInSeconds) {\n\t\t\treturn _drawOneFrameOnTime.call(thisInstance, localTimeInSeconds).pauseAnimation();\t\t\n\t\t}\n\n\t\tfunction _drawOneFrameOnTime(localTimeInSeconds) {\n\t\t\treturn _drawOrClearBg.call(thisInstance, localTimeInSeconds)\n\t\t\t\t.drawFrame(\n\t\t\t\t\tprivateData.elements.canvas,\n\t\t\t\t\tprivateData.data.canvasContext,\n\t\t\t\t\tlocalTimeInSeconds\n\t\t\t\t);\n\t\t}\n\n\t\tfunction _drawNextFrame(shouldClearCanvasBeforeDrawing) {\n\t\t\tvar privateState = privateData.state;\n\t\t\tif (privateState.animationIsPaused || privateState.animationIsStopped) return;\n\n\t\t\tif (typeof thisInstance.drawFrame !== 'function') {\n\t\t\t\tconsole.info(\n\t\t\t\t\t'The drawFrame \"method\" is not provided yet.',\n\t\t\t\t\t'Animation will not start.'\n\t\t\t\t);\n\t\t\t\tthisInstance.stopAnimation();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// I'd like to clear canvas also *BEFORE* checking the \"drawnFramesCount\".\n\t\t\tif (shouldClearCanvasBeforeDrawing) thisInstance.clearCanvas();\n\n\n\t\t\tprivateState.drawnFramesCount++;\n\t\t\tif (privateState.drawnFramesCount > state.drawingFramesCountLimitation) {\n\t\t\t\tconsole.log('Animation frame limitation met. Animation will stop now.');\n\t\t\t\tthisInstance.stopAnimation();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthisInstance.drawOneFrame();\n\n\t\t\trequestAnimationFrame(boundMethods.drawNextFrame);\n\t\t}\n\n\t\tfunction _drawOrClearBg() {\n\t\t\tvar canvas = privateData.elements.canvas;\n\t\t\tvar ctx = privateData.data.canvasContext;\n\n\t\t\tif (state.bgColor === null || state.bgColor === '' || state.bgColor === false) {\n\t\t\t\tthisInstance.clearCanvas();\n\t\t\t} else {\n\t\t\t\tctx.fillStyle = state.bgColor;\n\t\t\t\tctx.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t}\n\n\t\t\treturn thisInstance;\n\t\t}\n\t}\n\n\twlcCanvasAnimationController.isJQueryWrappedObjectOrAlike = function (object) {\n\t\treturn wlcCanvasAnimationController.isJQueryWrappedObject(object)\n\t\t\t|| object[0] instanceof Node;\n\t};\n\n\twlcCanvasAnimationController.isJQueryWrappedObject = function (object) {\n\t\treturn !!Object.getPrototypeOf(object).jquery;\n\t};\n\n\twlcCanvasAnimationController.isValidColor = function (color) {\n\t\treturn !!color;\n\t};\n\n\treturn wlcCanvasAnimationController;\n});\n"]}