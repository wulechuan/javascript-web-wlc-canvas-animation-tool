{"version":3,"sources":["wlc-canvas-animation-tool.js"],"names":["createWhatWeWant","window","wlcCanvasAnimationController","canvas","a","b","_init","initOptions","regExpCanvasContextType","thisInstance","pN_drawFrame","match","canvasContextType","trim","toLowerCase","canvasContext","getContext","config","call","animationShouldStop","b_startAnimation","getData","elements","data","state","shouldClearCanvasBeforeDrawing","bgColor","animationIsStopped","animationShouldPause","animationIsPaused","timeOffsetInSeconds","shouldPauseButNotStopWhenAnyLimiationMed","localTimeAfterWhichToStopOrPauseAnimation","localDurationBeyondWhichToStopOrPauseAnimation","wallTimeAfterWhichToStopOrPauseAnimation","drawingFramesCountLimitation","animationStartWallTime","localPlayingDurationInSeconds","localTimeInSeconds","drawnFramesCount","_definePublicState","publicState","Object","defineProperty","pN_shouldClearCanvasBeforeDrawing","enumerable","get","set","shouldClear","pN_bgColor","newColor","pN_isValidColor","pN_animationShouldStop","isToStopAnimation","stopAnimation","startAnimation","pN_animationIsStopped","console","warn","pN_animationShouldPause","isToPauseAnimation","pauseAnimation","resumeAnimation","pN_animationIsPaused","pN_timeOffsetInSeconds","offset","parseFloat","isNaN","pN_shouldPauseButNotStopWhenAnyLimiationMed","shouldPauseInsteadOfStop","pN_localDurationBeyondWhichToStopOrPauseAnimation","durationLimitation","pN_localTimeAfterWhichToStopOrPauseAnimation","timePoint","pN_wallTimeAfterWhichToStopOrPauseAnimation","dateTime","Math","max","Date","pN_drawingFramesCountLimitation","limitation","NaN","parseInt","options","hasOwnProperty","getCanvas","getCanvasContext","getCanvasContextType","clearCanvasViaMethod","b_clearCanvas","b_stopAnimation","_clearCanvas","clearRect","width","height","shouldClearCanvas","newTimeOffset","getTime","b_drawNextFrame","_drawNextFrame","info","atLeastOnLimiationMet","log","now","b_pauseAnimation","b_drawOneFrame","requestAnimationFrame","drawOneFrame","_drawOneFrameOnTime","drawOneFrameOnTimeViaMethod","_drawOrClearBg","fillStyle","fillRect","this","settings","canvasDefaultBgColor","canvasDefaultContextType","error","Node","document","getElementById","pN_isJQueryWrappedObjectOrAlike","tagName","DOMPropertyNameForThisTypeOfInstance","appendChild","createElement","writable","value","bind","b_resumeAnimation","drawOneFrameOnTime","clearCanvas","object","__proto__","jquery","color"],"mappings":"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","file":"wlc-canvas-animation-tool.min.js","sourcesContent":["(function (createWhatWeWant) {\n\twindow.wlcCanvasAnimationController = createWhatWeWant();\n})(function createWhatWeWant() {\n\n\t// To define some long property names this way helps js better minified.\n\t// Because we are using local variables as keys to access properties,\n\t// and local variables can be minified,\n\t// while strings and direct property keys can not be minified.\n\tvar DOMPropertyNameForThisTypeOfInstance = 'wlcCanvasAnimationControllerInstance';\n\tvar pN_isJQueryWrappedObjectOrAlike = 'isJQueryWrappedObjectOrAlike';\n\tvar pN_isJQueryWrappedObject = 'isJQueryWrappedObject';\n\tvar pN_isValidColor = 'isValidColor';\n\n\tvar pN_drawFrame = 'drawFrame';\n\n\tvar pN_shouldClearCanvasBeforeDrawing = 'shouldClearCanvasBeforeDrawing';\n\tvar pN_bgColor = 'bgColor';\n\n\tvar pN_animationShouldStop = 'animationShouldStop';\n\tvar pN_animationIsStopped = 'animationIsStopped';\n\tvar pN_animationShouldPause = 'animationShouldPause';\n\tvar pN_animationIsPaused = 'animationIsPaused';\n\n\tvar pN_timeOffsetInSeconds = 'timeOffsetInSeconds';\n\n\tvar pN_shouldPauseButNotStopWhenAnyLimiationMed = 'shouldPauseButNotStopWhenAnyLimiationMed';\n\tvar pN_localTimeAfterWhichToStopOrPauseAnimation = 'localTimeAfterWhichToStopOrPauseAnimation'; // in seconds\n\tvar pN_localDurationBeyondWhichToStopOrPauseAnimation = 'localDurationBeyondWhichToStopOrPauseAnimation'; // in seconds\n\tvar pN_wallTimeAfterWhichToStopOrPauseAnimation = 'wallTimeAfterWhichToStopOrPauseAnimation'; // in milliseconds\n\tvar pN_drawingFramesCountLimitation = 'drawingFramesCountLimitation';\n\n\n\n\t/**\n\t * Constructor for create an instant object that helps making canvas animations.\n\t * \n\t * @constructor\n\t * @author 吴乐川 <wulechuan@live.com>\n\t * @argument {!(string|Node|jQueryObject)} canvas the canvas element,\n\t * \tor the container object that is NOT a canvas element,\n\t *  under which a new canvas element will be created automatically.\n\t * \n\t * @argument {?(string|function|object)} a Multi-purpose.\n\t * \t\tIf 1 argument is provided:\n\t * \t\t>\tIf it's a string, it's treated as the canvas context type;\n\t * \t\t\tIf it's an object, it's treated as the \"options\" objet;\n\t * \t\t\tIf it's a function, it's treated as the \"drawFrame\" method.\n\t * \n\t * \t\tIf 2 arguments are provided:\n\t * \t\t>\tThe one that is a string is treated as the canvas context type;\n\t * \t\t\tThe one that is an object is treated as the \"options\" objet;\n\t * \t\t\tThe one that is a function is treated as the \"drawFrame\" method;\n\t * \n\t * \t\t\tTf both are of the same type, e. g. both are functions,\n\t * \t\t\tan error will be logged and construction will fail.\n\t * \n\t * \t\t\tIf a function is provided, while the other argument being an object,\n\t * \t\t\tand contains a function property named \"drawFrame\",\n\t * \t\t\tthen the property of the object argument is taken,\n\t * \t\t\tthe function argument is ignored.\n\t * \n\t * @argument {?(string|function|object)} b Multi-purpose.\n\t * >\tSee argument a.\n\t * \n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\tfunction myFancyDrawingFunction () { ... }\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t'3d',\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t */\n\n\tfunction wlcCanvasAnimationController(canvas, a, b) {\n\t\tvar thisInstance = this;\n\n\t\tvar settings = {\n\t\t\tcanvasDefaultBgColor: '',\n\t\t\tcanvasDefaultContextType: '2d'\n\t\t};\n\n\n\n\n\n\n\n\n\t\t// private variables\n\t\tvar canvasContext = null;\n\t\tvar canvasContextType = settings.canvasDefaultContextType;\n\n\t\tvar shouldClearCanvasBeforeDrawing = true;\n\t\tvar bgColor = settings.canvasDefaultBgColor;\n\n\t\tvar animationShouldStop = false;\n\t\tvar animationIsStopped = true;\n\t\tvar animationShouldPause = false;\n\t\tvar animationIsPaused = false;\n\n\t\tvar timeOffsetInSeconds = 0;\n\n\t\tvar shouldPauseButNotStopWhenAnyLimiationMed = false; // \"true\" means should stop instead of pause.\n\t\tvar localDurationBeyondWhichToStopOrPauseAnimation = NaN;\n\t\tvar localTimeAfterWhichToStopOrPauseAnimation = NaN;\n\t\tvar wallTimeAfterWhichToStopOrPauseAnimation = NaN;\n\t\tvar drawingFramesCountLimitation = NaN; // In case we need to draw like 1000 frames and then stop there for ever\n\n\n\t\t// internal derived values\n\t\tvar animationStartWallTime = NaN;\n\t\tvar localPlayingDurationInSeconds = 0;\n\t\tvar localTimeInSeconds = 0;\n\t\tvar drawnFramesCount = 0;\n\n\n\n\n\n\n\t\tif ((typeof a === 'object' && typeof b === 'object' && a && b)\n\t\t\t|| (typeof a === 'string' && typeof b === 'string')\n\t\t\t|| (typeof a === 'function' && typeof b === 'function')\n\t\t) {\n\t\t\tconsole && console.error('Invalid arguments.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!(canvas instanceof Node)) {\n\t\t\tif (typeof canvas === 'string') {\n\t\t\t\tcanvas = document.getElementById(canvas);\n\t\t\t} else if (wlcCanvasAnimationController[pN_isJQueryWrappedObjectOrAlike](canvas)) {\n\t\t\t\tcanvas = canvas[0];\n\t\t\t} else {\n\t\t\t\tcanvas = null;\n\t\t\t}\n\t\t}\n\n\t\tif (!canvas) {\n\t\t\tconsole && console.error('Invalid canvas provided.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (canvas.tagName.match(/canvas/i)) {\n\t\t\tif (canvas[DOMPropertyNameForThisTypeOfInstance]) {\n\t\t\t\treturn canvas[DOMPropertyNameForThisTypeOfInstance];\n\t\t\t}\n\t\t} else {\n\t\t\tcanvas = canvas.appendChild(document.createElement('canvas'));\n\t\t}\n\n\n\n\n\n\n\t\tObject.defineProperty(canvas, DOMPropertyNameForThisTypeOfInstance, {\n\t\t\tenumerable: true,\n\t\t\twritable: false,\n\t\t\tvalue: thisInstance\n\t\t});\n\n\n\n\n\n\n\t\tvar requestAnimationFrame = window.requestAnimationFrame;\n\n\n\t\t// Being public means being writable.\n\t\tvar publicState = _definePublicState.call(thisInstance);\n\t\tthisInstance.state = publicState;\n\n\n\t\t// Define \"this\"-bound methods for conveniences and better source code minification.\n\t\tvar b_drawNextFrame = _drawNextFrame.bind(thisInstance);\n\t\tvar b_stopAnimation = stopAnimation.bind(thisInstance);\n\t\tvar b_startAnimation = startAnimation.bind(thisInstance);\n\t\tvar b_pauseAnimation = pauseAnimation.bind(thisInstance);\n\t\tvar b_resumeAnimation = resumeAnimation.bind(thisInstance);\n\t\tvar b_clearCanvas = _clearCanvas.bind(thisInstance);\n\t\tvar b_drawOneFrame = drawOneFrame.bind(thisInstance);\n\n\n\t\tthisInstance.config = config.bind(thisInstance);\n\t\tthisInstance.getData = getData.bind(thisInstance);\n\t\tthisInstance.getCanvas = getCanvas.bind(thisInstance);\n\t\tthisInstance.getCanvasContext = getCanvasContext.bind(thisInstance);\n\t\tthisInstance.getCanvasContextType = getCanvasContextType.bind(thisInstance);\n\n\t\tthisInstance.stopAnimation = b_stopAnimation;\n\t\tthisInstance.startAnimation = b_startAnimation;\n\t\tthisInstance.pauseAnimation = b_pauseAnimation;\n\t\tthisInstance.resumeAnimation = b_resumeAnimation;\n\n\t\tthisInstance.drawOneFrame = b_drawOneFrame;\n\t\tthisInstance.drawOneFrameOnTime = drawOneFrameOnTimeViaMethod.bind(thisInstance);\n\t\tthisInstance.clearCanvas = clearCanvasViaMethod.bind(thisInstance);\n\n\n\n\t\t_init.call(thisInstance, a, b);\n\n\n\n\n\n\n\n\t\tfunction _init(a, b) {\n\t\t\tvar regExpCanvasContextType = /\\s*(2d|3d|webgl)\\s*/i;\n\t\t\tvar initOptions;\n\n\t\t\tif (typeof a === 'object' && a) {\n\t\t\t\tinitOptions = a;\n\n\t\t\t\tif (typeof b === 'function') {\n\t\t\t\t\tthisInstance[pN_drawFrame] = b;\n\t\t\t\t} else if (typeof b === 'string' && b.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = b.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof b === 'object' && b) {\n\t\t\t\tinitOptions = b;\n\n\t\t\t\tif (typeof a === 'function') {\n\t\t\t\t\tthisInstance[pN_drawFrame] = a;\n\t\t\t\t} else if (typeof a === 'string' && a.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = a.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcanvasContext = canvas.getContext(canvasContextType);\n\n\t\t\tconfig.call(thisInstance, initOptions);\n\n\n\t\t\tif (!animationShouldStop) {\n\t\t\t\t// if animationShouldPause,\n\t\t\t\t// then we still need to first start the animation.\n\t\t\t\t// Because to pause a stopped animation doesn't make any sence.\n\t\t\t\treturn b_startAnimation();\n\t\t\t}\n\t\t}\n\n\n\n\t\t/**\n\t\t * Get a copy of all private data just for inspection\n\t\t * @return {object}\n\t\t */\n\t\tfunction getData() {\n\t\t\treturn {\n\t\t\t\telements: {\n\t\t\t\t\tcanvas: canvas\n\t\t\t\t},\n\t\t\t\tdata: {\n\t\t\t\t\tcanvasContext: canvasContext,\n\t\t\t\t\tcanvasContextType: canvasContextType\n\t\t\t\t},\n\t\t\t\tstate: {\n\t\t\t\t\tshouldClearCanvasBeforeDrawing: shouldClearCanvasBeforeDrawing,\n\t\t\t\t\tbgColor: bgColor,\n\n\t\t\t\t\tanimationShouldStop: animationShouldStop,\n\t\t\t\t\tanimationIsStopped: animationIsStopped,\n\t\t\t\t\tanimationShouldPause: animationShouldPause,\n\t\t\t\t\tanimationIsPaused: animationIsPaused,\n\n\t\t\t\t\ttimeOffsetInSeconds: timeOffsetInSeconds,\n\n\t\t\t\t\tshouldPauseButNotStopWhenAnyLimiationMed: shouldPauseButNotStopWhenAnyLimiationMed,\n\t\t\t\t\tlocalTimeAfterWhichToStopOrPauseAnimation: localTimeAfterWhichToStopOrPauseAnimation,\n\t\t\t\t\tlocalDurationBeyondWhichToStopOrPauseAnimation: localDurationBeyondWhichToStopOrPauseAnimation,\n\t\t\t\t\twallTimeAfterWhichToStopOrPauseAnimation: wallTimeAfterWhichToStopOrPauseAnimation,\n\t\t\t\t\tdrawingFramesCountLimitation: drawingFramesCountLimitation,\n\n\t\t\t\t\t// internal derived values\n\t\t\t\t\tanimationStartWallTime: animationStartWallTime,\n\t\t\t\t\tlocalPlayingDurationInSeconds: localPlayingDurationInSeconds,\n\t\t\t\t\tlocalTimeInSeconds: localTimeInSeconds,\n\t\t\t\t\tdrawnFramesCount: drawnFramesCount\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Define some properties using getters and setters,\n\t\t * So that they can be accessed directly in public.\n\t\t * @return {object}\n\t\t */\n\t\tfunction _definePublicState() {\n\t\t\tvar publicState = {};\n\n\t\t\tObject.defineProperty(publicState, pN_shouldClearCanvasBeforeDrawing, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn shouldClearCanvasBeforeDrawing;\n\t\t\t\t},\n\t\t\t\tset: function (shouldClear) {\n\t\t\t\t\tshouldClearCanvasBeforeDrawing = !!shouldClear;\n\t\t\t\t\treturn shouldClearCanvasBeforeDrawing;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_bgColor, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn bgColor;\n\t\t\t\t},\n\t\t\t\tset: function (newColor) {\n\t\t\t\t\tif (wlcCanvasAnimationController[pN_isValidColor](newColor)) {\n\t\t\t\t\t\tbgColor = newColor.trim().toLowerCase();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn bgColor;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationShouldStop, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationShouldStop;\n\t\t\t\t},\n\t\t\t\tset: function (isToStopAnimation) {\n\t\t\t\t\tif (isToStopAnimation) {\n\t\t\t\t\t\tstopAnimation.call(thisInstance);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartAnimation.call(thisInstance);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn animationShouldStop;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationIsStopped, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationIsStopped;\n\t\t\t\t},\n\t\t\t\tset: function () {\n\t\t\t\t\tconsole.warn('state.'+pN_animationIsStopped+' is a read-only property.');\n\t\t\t\t\treturn animationIsStopped;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationShouldPause, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationShouldPause;\n\t\t\t\t},\n\t\t\t\tset: function (isToPauseAnimation) {\n\t\t\t\t\tif (isToPauseAnimation) {\n\t\t\t\t\t\tpauseAnimation.call(thisInstance);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresumeAnimation.call(thisInstance);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn animationShouldPause;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationIsPaused, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationIsPaused;\n\t\t\t\t},\n\t\t\t\tset: function () {\n\t\t\t\t\tconsole.warn('state.'+pN_animationIsPaused+' is a read-only property.');\n\t\t\t\t\treturn animationIsPaused;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_timeOffsetInSeconds, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn timeOffsetInSeconds;\n\t\t\t\t},\n\t\t\t\tset: function (offset) {\n\t\t\t\t\toffset = parseFloat(offset);\n\t\t\t\t\tif (!isNaN(offset)) {\n\t\t\t\t\t\ttimeOffsetInSeconds = offset;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn timeOffsetInSeconds;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_shouldPauseButNotStopWhenAnyLimiationMed, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn shouldPauseButNotStopWhenAnyLimiationMed;\n\t\t\t\t},\n\t\t\t\tset: function (shouldPauseInsteadOfStop) {\n\t\t\t\t\tshouldPauseButNotStopWhenAnyLimiationMed = !!shouldPauseInsteadOfStop;\n\t\t\t\t\treturn shouldPauseButNotStopWhenAnyLimiationMed;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_localDurationBeyondWhichToStopOrPauseAnimation, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn localDurationBeyondWhichToStopOrPauseAnimation;\n\t\t\t\t},\n\t\t\t\tset: function (durationLimitation) {\n\t\t\t\t\tdurationLimitation = parseFloat(durationLimitation);\n\t\t\t\t\tif (!isNaN(durationLimitation) && durationLimitation>=0) {\n\t\t\t\t\t\tlocalDurationBeyondWhichToStopOrPauseAnimation = durationLimitation;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn localDurationBeyondWhichToStopOrPauseAnimation;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_localTimeAfterWhichToStopOrPauseAnimation, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn localTimeAfterWhichToStopOrPauseAnimation;\n\t\t\t\t},\n\t\t\t\tset: function (timePoint) {\n\t\t\t\t\ttimePoint = parseFloat(timePoint);\n\t\t\t\t\tif (!isNaN(timePoint)) {\n\t\t\t\t\t\tlocalTimeAfterWhichToStopOrPauseAnimation = timePoint;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn localTimeAfterWhichToStopOrPauseAnimation;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_wallTimeAfterWhichToStopOrPauseAnimation, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn wallTimeAfterWhichToStopOrPauseAnimation;\n\t\t\t\t},\n\t\t\t\tset: function (dateTime) {\n\t\t\t\t\tdateTime = parseFloat(dateTime);\n\t\t\t\t\tif (!isNaN(dateTime) && dateTime>=0) {\n\t\t\t\t\t\twallTimeAfterWhichToStopOrPauseAnimation = Math.max(new Date(), dateTime);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn wallTimeAfterWhichToStopOrPauseAnimation;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_drawingFramesCountLimitation, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn drawingFramesCountLimitation;\n\t\t\t\t},\n\t\t\t\tset: function (limitation) {\n\t\t\t\t\tif (isNaN(limitation)) {\n\t\t\t\t\t\tdrawingFramesCountLimitation = NaN;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlimitation = parseInt(limitation);\n\t\t\t\t\t\tif (!isNaN(limitation) && limitation>=0) {\n\t\t\t\t\t\t\tdrawingFramesCountLimitation = limitation;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn drawingFramesCountLimitation;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn publicState;\n\t\t}\n\n\t\tfunction config(options) {\n\t\t\toptions = options || {};\n\n\t\t\tif (typeof options === 'function') {\n\t\t\t\tthisInstance[pN_drawFrame] = options;\n\t\t\t\treturn thisInstance;\n\t\t\t}\n\n\t\t\tif (typeof options[pN_drawFrame] === 'function') {\n\t\t\t\tthisInstance[pN_drawFrame] = options[pN_drawFrame];\n\t\t\t}\n\n\n\t\t\t// Just use defined setters to update public values,\n\t\t\t// so that we don't need to write type/value validation codes again here.\n\t\t\tif (options.hasOwnProperty(pN_shouldClearCanvasBeforeDrawing)) {\n\t\t\t\tpublicState[pN_shouldClearCanvasBeforeDrawing] =\n\t\t\t\t\toptions[pN_shouldClearCanvasBeforeDrawing];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_bgColor)) {\n\t\t\t\tpublicState[pN_bgColor] =\n\t\t\t\t\toptions[pN_bgColor];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_animationShouldStop)) {\n\t\t\t\tpublicState[pN_animationShouldStop] =\n\t\t\t\t\toptions[pN_animationShouldStop];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_animationShouldPause)) {\n\t\t\t\tpublicState[pN_animationShouldPause] =\n\t\t\t\t\toptions[pN_animationShouldPause];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_timeOffsetInSeconds)) {\n\t\t\t\tpublicState[pN_timeOffsetInSeconds] =\n\t\t\t\t\toptions[pN_timeOffsetInSeconds];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_shouldPauseButNotStopWhenAnyLimiationMed)) {\n\t\t\t\tpublicState[pN_shouldPauseButNotStopWhenAnyLimiationMed] =\n\t\t\t\t\toptions[pN_shouldPauseButNotStopWhenAnyLimiationMed];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_localTimeAfterWhichToStopOrPauseAnimation)) {\n\t\t\t\tpublicState[pN_localTimeAfterWhichToStopOrPauseAnimation] =\n\t\t\t\t\toptions[pN_localTimeAfterWhichToStopOrPauseAnimation];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_localDurationBeyondWhichToStopOrPauseAnimation)) {\n\t\t\t\tpublicState[pN_localDurationBeyondWhichToStopOrPauseAnimation] =\n\t\t\t\t\toptions[pN_localDurationBeyondWhichToStopOrPauseAnimation];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_wallTimeAfterWhichToStopOrPauseAnimation)) {\n\t\t\t\tpublicState[pN_wallTimeAfterWhichToStopOrPauseAnimation] =\n\t\t\t\t\toptions[pN_wallTimeAfterWhichToStopOrPauseAnimation];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_drawingFramesCountLimitation)) {\n\t\t\t\tpublicState[pN_drawingFramesCountLimitation] =\n\t\t\t\t\toptions[pN_drawingFramesCountLimitation];\n\t\t\t}\n\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction getCanvas() {\n\t\t\treturn canvas;\n\t\t}\n\n\t\tfunction getCanvasContext() {\n\t\t\treturn canvasContext;\n\t\t}\n\n\t\tfunction getCanvasContextType() {\n\t\t\treturn canvasContextType;\n\t\t}\n\n\t\tfunction clearCanvasViaMethod() {\n\t\t\tb_clearCanvas();\n\t\t\treturn b_stopAnimation(); // for chaining method invocations\n\t\t}\n\n\t\tfunction _clearCanvas() {\n\t\t\tcanvasContext.clearRect(0, 0, canvas.width, canvas.height);\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction stopAnimation(shouldClearCanvas) {\n\t\t\tanimationIsStopped = true;\n\t\t\tanimationIsPaused = false;\n\n\t\t\tanimationShouldPause = false;\n\t\t\tanimationShouldStop = false;\n\n\t\t\tlocalDurationBeyondWhichToStopOrPauseAnimation = NaN;\n\t\t\tlocalTimeAfterWhichToStopOrPauseAnimation = NaN;\n\t\t\twallTimeAfterWhichToStopOrPauseAnimation = NaN;\n\t\t\tdrawingFramesCountLimitation = NaN;\n\n\t\t\tif (shouldClearCanvas) b_clearCanvas();\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction startAnimation(newTimeOffset) {\n\t\t\tif (!animationIsPaused && !animationIsStopped) {\n\t\t\t\treturn thisInstance;\n\t\t\t}\n\n\t\t\tanimationIsStopped = false;\n\t\t\tanimationIsPaused = false;\n\n\t\t\tdrawnFramesCount = 0;\n\t\t\tlocalPlayingDurationInSeconds = 0;\n\n\t\t\t// Set twice, if the second value (which is the argument) is invalid and not taken\n\t\t\t// Then the first value (which is zero) takes effects.\n\t\t\tpublicState[pN_timeOffsetInSeconds] = 0;\n\t\t\tpublicState[pN_timeOffsetInSeconds] = newTimeOffset;\n\n\t\t\tanimationStartWallTime = new Date().getTime() - timeOffsetInSeconds;\n\n\t\t\tb_drawNextFrame();\n\n\t\t\t// animationShouldStop = false;\n\t\t\t// animationShouldPause = false;\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction pauseAnimation() {\n\t\t\tif (animationIsStopped || animationIsPaused) return;\n\t\t\tanimationIsPaused = true;\n\t\t\tanimationShouldPause = false;\n\n\t\t\tdrawingFramesCountLimitation = NaN;\n\t\t\tlocalDurationBeyondWhichToStopOrPauseAnimation = NaN;\n\t\t\tlocalTimeAfterWhichToStopOrPauseAnimation = NaN;\n\t\t\twallTimeAfterWhichToStopOrPauseAnimation = NaN;\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction resumeAnimation() {\n\t\t\tif (animationIsStopped || !animationIsPaused) return;\n\n\t\t\tanimationIsPaused = false;\n\t\t\tb_drawNextFrame();\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction _drawNextFrame(/* DOMHighResTimeStamp */) {\n\t\t\t// The \"DOMHighResTimeStamp\" provided by the browser\n\t\t\t// is more accurate but unfortunately NOT what I want.\n\n\t\t\tif (animationIsPaused || animationIsStopped) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (animationShouldStop) {\n\t\t\t\tb_stopAnimation();\n\t\t\t}\n\n\t\t\tif (typeof thisInstance[pN_drawFrame] !== 'function') {\n\t\t\t\tconsole.info(\n\t\t\t\t\t'The \"drawFrame\" method is not provided yet.',\n\t\t\t\t\t'Animation will not start.'\n\t\t\t\t);\n\t\t\t\tb_stopAnimation();\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tvar atLeastOnLimiationMet = false;\n\n\t\t\t// Using common strings for better source code compression.\n\t\t\tvar commonString1 = 'Animation';\n\t\t\tvar commonString2 = 'limitation met.';\n\n\t\t\tdrawnFramesCount++;\n\t\t\tif (drawnFramesCount > drawingFramesCountLimitation) {\n\t\t\t\tatLeastOnLimiationMet = true;\n\t\t\t\tconsole.log(commonString1, 'frame', commonString2);\n\t\t\t}\n\n\n\t\t\tvar now = new Date();\n\t\t\tif (now >= wallTimeAfterWhichToStopOrPauseAnimation) {\n\t\t\t\tatLeastOnLimiationMet = true;\n\t\t\t\tconsole.log(commonString1, 'time', commonString2);\n\t\t\t}\n\n\n\t\t\tlocalPlayingDurationInSeconds = (now - animationStartWallTime) / 1000;\n\t\t\tif (localPlayingDurationInSeconds >= localDurationBeyondWhichToStopOrPauseAnimation) {\n\t\t\t\tatLeastOnLimiationMet = true;\n\t\t\t\tconsole.log(commonString1, 'running duration', commonString2);\n\t\t\t}\n\n\n\t\t\tlocalTimeInSeconds = localPlayingDurationInSeconds + timeOffsetInSeconds;\n\t\t\tif (localTimeInSeconds >= localTimeAfterWhichToStopOrPauseAnimation) {\n\t\t\t\tatLeastOnLimiationMet = true;\n\t\t\t\tconsole.log(commonString1, 'local time', commonString2);\n\t\t\t}\n\n\t\t\tif (atLeastOnLimiationMet) {\n\t\t\t\tconsole.log(\n\t\t\t\t\t'Animation will',\n\t\t\t\t\tshouldPauseButNotStopWhenAnyLimiationMed ? 'pause' : 'stop',\n\t\t\t\t\t'now.'\n\t\t\t\t);\n\t\t\t\tif (shouldPauseButNotStopWhenAnyLimiationMed) {\n\t\t\t\t\treturn b_pauseAnimation();\n\t\t\t\t} else {\n\t\t\t\t\treturn b_stopAnimation();\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (animationShouldPause) {\n\t\t\t\treturn b_pauseAnimation();\n\t\t\t}\n\n\t\t\tb_drawOneFrame();\n\n\t\t\trequestAnimationFrame(b_drawNextFrame);\n\t\t}\n\n\t\tfunction drawOneFrame() {\n\t\t\treturn _drawOneFrameOnTime.call(thisInstance, localTimeInSeconds);\n\t\t}\n\n\t\tfunction drawOneFrameOnTimeViaMethod(localTimeInSeconds) {\n\t\t\t_drawOneFrameOnTime.call(thisInstance, localTimeInSeconds);\n\t\t\treturn pauseAnimation.call(thisInstance); // for chaining method invocations\n\t\t}\n\n\t\tfunction _drawOneFrameOnTime(localTimeInSeconds) {\n\t\t\t_drawOrClearBg.call(thisInstance, localTimeInSeconds)[\n\t\t\t\tpN_drawFrame\n\t\t\t](canvas, canvasContext, localTimeInSeconds);\n\t\t\treturn thisInstance;\n\t\t}\n\n\t\tfunction _drawOrClearBg() {\n\t\t\tif (shouldClearCanvasBeforeDrawing) {\n\t\t\t\tb_clearCanvas();\n\t\t\t}\n\n\t\t\tcanvasContext.fillStyle = bgColor;\n\t\t\tcanvasContext.fillRect(0, 0, canvas.width, canvas.height);\n\n\t\t\treturn thisInstance;\n\t\t}\n\t}\n\n\twlcCanvasAnimationController[pN_isJQueryWrappedObjectOrAlike] = function (object) {\n\t\treturn wlcCanvasAnimationController[pN_isJQueryWrappedObject](object)\n\t\t\t|| object[0] instanceof Node;\n\t};\n\n\twlcCanvasAnimationController[pN_isJQueryWrappedObject] = function (object) {\n\t\treturn !!object.__proto__.jquery;\n\t};\n\n\twlcCanvasAnimationController[pN_isValidColor] = function (color) {\n\t\treturn typeof color === 'string' || !!color;\n\t};\n\n\treturn wlcCanvasAnimationController;\n});\n"]}