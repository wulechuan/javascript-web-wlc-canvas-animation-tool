{"version":3,"sources":["wlc-canvas-animation-tool.js"],"names":["createWhatWeWant","window","wlcCanvasAnimationController","canvas","a","b","_init","initOptions","regExpCanvasContextType","thisInstance","drawFrame","match","canvasContextType","trim","toLowerCase","canvasContext","getContext","config","call","animationShouldStop","b_startAnimation","getData","elements","data","state","animationIsStopped","animationShouldPause","animationIsPaused","animationStartWallTime","timeOffsetInSeconds","localPlayingDurationInSeconds","localTimeInSeconds","drawnFramesCount","drawingFramesCountLimitation","_definePublicState","publicState","Object","defineProperty","pN_animationIsStopped","enumerable","get","set","console","warn","pN_animationIsPaused","pN_animationShouldStop","isToStopAnimation","stopAnimation","startAnimation","pN_animationShouldPause","isToPauseAnimation","pauseAnimation","resumeAnimation","pN_drawingFramesCountLimitation","limitation","isNaN","NaN","parseInt","pN_timeOffsetInSeconds","offset","parseFloat","pN_bgColor","bgColor","newColor","pN_isValidColor","options","hasOwnProperty","getCanvas","getCanvasContext","getCanvasContextType","clearCanvas","b_clearCanvas","b_stopAnimation","_clearCanvas","clearRect","width","height","shouldClearCanvas","newTimeOffset","Date","getTime","b_drawNextFrame","_drawNextFrame","info","log","b_pauseAnimation","b_drawOneFrame","requestAnimationFrame","drawOneFrame","_drawOneFrameOnTime","drawOneFrameOnTimeViaMethod","_drawOrClearBg","fillStyle","fillRect","this","settings","canvasDefaultBgColor","canvasDefaultContextType","error","Node","document","getElementById","pN_isJQueryWrappedObjectOrAlike","tagName","DOMPropertyNameForThisTypeOfInstance","appendChild","createElement","writable","value","bind","b_resumeAnimation","drawOneFrameOnTime","object","__proto__","jquery","color"],"mappings":"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","file":"wlc-canvas-animation-tool.min.js","sourcesContent":["(function (createWhatWeWant) {\n\twindow.wlcCanvasAnimationController = createWhatWeWant();\n})(function createWhatWeWant() {\n\n\t// To define some long property names this way helps js better minified.\n\t// Because we are using local variables as keys to access properties,\n\t// and local variables can be minified,\n\t// while strings and direct property keys can not be minified.\n\tvar DOMPropertyNameForThisTypeOfInstance = 'wlcCanvasAnimationControllerInstance';\n\tvar pN_isJQueryWrappedObjectOrAlike = 'isJQueryWrappedObjectOrAlike';\n\tvar pN_isJQueryWrappedObject = 'isJQueryWrappedObject';\n\tvar pN_isValidColor = 'isValidColor';\n\n\tvar pN_animationShouldStop = 'animationShouldStop';\n\tvar pN_animationIsStopped = 'animationIsStopped';\n\tvar pN_animationShouldPause = 'animationShouldPause';\n\tvar pN_animationIsPaused = 'animationIsPaused';\n\n\tvar pN_drawingFramesCountLimitation = 'drawingFramesCountLimitation';\n\tvar pN_timeOffsetInSeconds = 'timeOffsetInSeconds';\n\n\tvar pN_bgColor = 'bgColor';\n\n\n\t/**\n\t * Constructor for create an instant object that helps making canvas animations.\n\t * \n\t * @constructor\n\t * @author 吴乐川 <wulechuan@live.com>\n\t * @argument {!(string|Node|jQueryObject)} canvas the canvas element,\n\t * \tor the container object that is NOT a canvas element,\n\t *  under which a new canvas element will be created automatically.\n\t * \n\t * @argument {?(string|function|object)} a Multi-purpose.\n\t * \t\tIf 1 argument is provided:\n\t * \t\t>\tIf it's a string, it's treated as the canvas context type;\n\t * \t\t\tIf it's an object, it's treated as the \"options\" objet;\n\t * \t\t\tIf it's a function, it's treated as the \"drawFrame\" method.\n\t * \n\t * \t\tIf 2 arguments are provided:\n\t * \t\t>\tThe one that is a string is treated as the canvas context type;\n\t * \t\t\tThe one that is an object is treated as the \"options\" objet;\n\t * \t\t\tThe one that is a function is treated as the \"drawFrame\" method;\n\t * \n\t * \t\t\tTf both are of the same type, e. g. both are functions,\n\t * \t\t\tan error will be logged and construction will fail.\n\t * \n\t * \t\t\tIf a function is provided, while the other argument being an object,\n\t * \t\t\tand contains a function property named \"drawFrame\",\n\t * \t\t\tthen the property of the object argument is taken,\n\t * \t\t\tthe function argument is ignored.\n\t * \n\t * @argument {?(string|function|object)} b Multi-purpose.\n\t * >\tSee argument a.\n\t * \n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\tfunction myFancyDrawingFunction () { ... }\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t * \n\t * @example\n\t * \tvar myCanvas = document.querySelector('#my-canvas');\n\t *  var myAniCtrl = new wlcCanvasAnimationController(\n\t * \t\tmyCanvas,\n\t * \t\t'3d',\n\t * \t\t{\n\t * \t\t\tdrawFrame: function myFancyDrawingFunction() { ... }\n\t * \t\t}\n\t *  );\n\t */\n\n\tfunction wlcCanvasAnimationController(canvas, a, b) {\n\t\tvar thisInstance = this;\n\n\t\tvar settings = {\n\t\t\tcanvasDefaultBgColor: '',\n\t\t\tcanvasDefaultContextType: '2d'\n\t\t};\n\n\n\n\n\n\n\n\n\t\t// private variables\n\t\tvar canvasContext = null;\n\t\tvar canvasContextType = settings.canvasDefaultContextType;\n\t\tvar bgColor = settings.canvasDefaultBgColor;\n\n\t\tvar animationShouldStop = false;\n\t\tvar animationIsStopped = true;\n\t\tvar animationShouldPause = false;\n\t\tvar animationIsPaused = false;\n\n\t\tvar animationStartWallTime = NaN;\n\t\tvar timeOffsetInSeconds = 0;\n\t\tvar localPlayingDurationInSeconds = 0;\n\t\tvar localTimeInSeconds = 0;\n\n\t\tvar drawnFramesCount = 0;\n\t\tvar drawingFramesCountLimitation = NaN; // In case we need to draw like 1000 frames and then stop there for ever\n\n\n\n\n\n\n\t\tif ((typeof a === 'object' && typeof b === 'object' && a && b)\n\t\t\t|| (typeof a === 'string' && typeof b === 'string')\n\t\t\t|| (typeof a === 'function' && typeof b === 'function')\n\t\t) {\n\t\t\tconsole && console.error('Invalid arguments.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!(canvas instanceof Node)) {\n\t\t\tif (typeof canvas === 'string') {\n\t\t\t\tcanvas = document.getElementById(canvas);\n\t\t\t} else if (wlcCanvasAnimationController[pN_isJQueryWrappedObjectOrAlike](canvas)) {\n\t\t\t\tcanvas = canvas[0];\n\t\t\t} else {\n\t\t\t\tcanvas = null;\n\t\t\t}\n\t\t}\n\n\t\tif (!canvas) {\n\t\t\tconsole && console.error('Invalid canvas provided.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (canvas.tagName.match(/canvas/i)) {\n\t\t\tif (canvas[DOMPropertyNameForThisTypeOfInstance]) {\n\t\t\t\treturn canvas[DOMPropertyNameForThisTypeOfInstance];\n\t\t\t}\n\t\t} else {\n\t\t\tcanvas = canvas.appendChild(document.createElement('canvas'));\n\t\t}\n\n\n\n\n\n\n\t\tObject.defineProperty(canvas, DOMPropertyNameForThisTypeOfInstance, {\n\t\t\tenumerable: true,\n\t\t\twritable: false,\n\t\t\tvalue: thisInstance\n\t\t});\n\n\n\n\n\n\n\t\tvar requestAnimationFrame = window.requestAnimationFrame;\n\n\n\t\t// Being public means being writable.\n\t\tvar publicState = _definePublicState.call(thisInstance);\n\t\tthisInstance.state = publicState;\n\n\n\t\t// Define \"this\"-bound methods for conveniences and better source code minification.\n\t\tvar b_drawNextFrame = _drawNextFrame.bind(thisInstance);\n\t\tvar b_stopAnimation = stopAnimation.bind(thisInstance);\n\t\tvar b_startAnimation = startAnimation.bind(thisInstance);\n\t\tvar b_pauseAnimation = pauseAnimation.bind(thisInstance);\n\t\tvar b_resumeAnimation = resumeAnimation.bind(thisInstance);\n\t\tvar b_clearCanvas = clearCanvas.bind(thisInstance);\n\t\tvar b_drawOneFrame = drawOneFrame.bind(thisInstance);\n\n\n\t\tthisInstance.config = config.bind(thisInstance);\n\t\tthisInstance.getData = getData.bind(thisInstance);\n\t\tthisInstance.getCanvas = getCanvas.bind(thisInstance);\n\t\tthisInstance.getCanvasContext = getCanvasContext.bind(thisInstance);\n\t\tthisInstance.getCanvasContextType = getCanvasContextType.bind(thisInstance);\n\n\t\tthisInstance.clearCanvas = b_clearCanvas;\n\t\tthisInstance.stopAnimation = b_stopAnimation;\n\t\tthisInstance.startAnimation = b_startAnimation;\n\t\tthisInstance.pauseAnimation = b_pauseAnimation;\n\t\tthisInstance.resumeAnimation = b_resumeAnimation;\n\n\t\tthisInstance.drawOneFrame = b_drawOneFrame;\n\t\tthisInstance.drawOneFrameOnTime = drawOneFrameOnTimeViaMethod.bind(thisInstance);\n\n\n\n\t\t_init.call(thisInstance, a, b);\n\n\n\n\n\n\n\n\t\tfunction _init(a, b) {\n\t\t\tvar regExpCanvasContextType = /\\s*(2d|3d|webgl)\\s*/i;\n\t\t\tvar initOptions;\n\n\t\t\tif (typeof a === 'object' && a) {\n\t\t\t\tinitOptions = a;\n\n\t\t\t\tif (typeof b === 'function') {\n\t\t\t\t\tthisInstance.drawFrame = b;\n\t\t\t\t} else if (typeof b === 'string' && b.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = b.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof b === 'object' && b) {\n\t\t\t\tinitOptions = b;\n\n\t\t\t\tif (typeof a === 'function') {\n\t\t\t\t\tthisInstance.drawFrame = a;\n\t\t\t\t} else if (typeof a === 'string' && a.match(regExpCanvasContextType)) {\n\t\t\t\t\tcanvasContextType = a.trim().toLowerCase();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcanvasContext = canvas.getContext(canvasContextType);\n\n\t\t\tconfig.call(thisInstance, initOptions);\n\n\n\t\t\tif (!animationShouldStop) {\n\t\t\t\t// if animationShouldPause,\n\t\t\t\t// then we still need to first start the animation.\n\t\t\t\t// Because to pause a stopped animation doesn't make any sence.\n\t\t\t\treturn b_startAnimation();\n\t\t\t}\n\t\t}\n\n\n\n\t\t/**\n\t\t * Get a copy of all private data just for inspection\n\t\t * @return {object}\n\t\t */\n\t\tfunction getData() {\n\t\t\treturn {\n\t\t\t\telements: {\n\t\t\t\t\tcanvas: canvas\n\t\t\t\t},\n\t\t\t\tdata: {\n\t\t\t\t\tcanvasContext: canvasContext,\n\t\t\t\t\tcanvasContextType: canvasContextType\n\t\t\t\t},\n\t\t\t\tstate: {\n\t\t\t\t\tanimationShouldStop: animationShouldStop,\n\t\t\t\t\tanimationIsStopped: animationIsStopped,\n\t\t\t\t\tanimationShouldPause: animationShouldPause,\n\t\t\t\t\tanimationIsPaused: animationIsPaused,\n\t\t\t\t\tanimationStartWallTime: animationStartWallTime,\n\t\t\t\t\ttimeOffsetInSeconds: timeOffsetInSeconds,\n\t\t\t\t\tlocalPlayingDurationInSeconds: localPlayingDurationInSeconds,\n\t\t\t\t\tlocalTimeInSeconds: localTimeInSeconds,\n\t\t\t\t\tdrawnFramesCount: drawnFramesCount,\n\t\t\t\t\tdrawingFramesCountLimitation: drawingFramesCountLimitation\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * Define some properties using getters and setters,\n\t\t * So that they can be accessed directly in public.\n\t\t * @return {object}\n\t\t */\n\t\tfunction _definePublicState() {\n\t\t\tvar publicState = {};\n\n\t\t\tObject.defineProperty(publicState, pN_animationIsStopped, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationIsStopped;\n\t\t\t\t},\n\t\t\t\tset: function () {\n\t\t\t\t\tconsole.warn('state.'+pN_animationIsStopped+' is a read-only property.');\n\t\t\t\t\treturn animationIsStopped;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationIsPaused, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationIsPaused;\n\t\t\t\t},\n\t\t\t\tset: function () {\n\t\t\t\t\tconsole.warn('state.'+pN_animationIsPaused+' is a read-only property.');\n\t\t\t\t\treturn animationIsPaused;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationShouldStop, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationShouldStop;\n\t\t\t\t},\n\t\t\t\tset: function (isToStopAnimation) {\n\t\t\t\t\tif (isToStopAnimation) {\n\t\t\t\t\t\tstopAnimation.call(thisInstance);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstartAnimation.call(thisInstance);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn animationShouldStop;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_animationShouldPause, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn animationShouldPause;\n\t\t\t\t},\n\t\t\t\tset: function (isToPauseAnimation) {\n\t\t\t\t\tif (isToPauseAnimation) {\n\t\t\t\t\t\tpauseAnimation.call(thisInstance);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresumeAnimation.call(thisInstance);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn animationShouldPause;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_drawingFramesCountLimitation, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn drawingFramesCountLimitation;\n\t\t\t\t},\n\t\t\t\tset: function (limitation) {\n\t\t\t\t\tif (isNaN(limitation)) {\n\t\t\t\t\t\tdrawingFramesCountLimitation = NaN;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlimitation = parseInt(limitation);\n\t\t\t\t\t\tif (!isNaN(limitation)) {\n\t\t\t\t\t\t\tdrawingFramesCountLimitation = limitation;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn drawingFramesCountLimitation;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_timeOffsetInSeconds, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn timeOffsetInSeconds;\n\t\t\t\t},\n\t\t\t\tset: function (offset) {\n\t\t\t\t\toffset = parseFloat(offset);\n\t\t\t\t\tif (!isNaN(offset)) {\n\t\t\t\t\t\ttimeOffsetInSeconds = offset;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn timeOffsetInSeconds;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tObject.defineProperty(publicState, pN_bgColor, {\n\t\t\t\tenumerable: true,\n\t\t\t\tget: function () {\n\t\t\t\t\treturn bgColor;\n\t\t\t\t},\n\t\t\t\tset: function (newColor) {\n\t\t\t\t\tif (wlcCanvasAnimationController[pN_isValidColor](newColor)) {\n\t\t\t\t\t\tbgColor = newColor.trim().toLowerCase();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn bgColor;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn publicState;\n\t\t}\n\n\t\tfunction config(options) {\n\t\t\toptions = options || {};\n\t\t\tvar _inputTemp;\n\n\n\t\t\t// Just use defined setters to update public values,\n\t\t\t// so that we don't need to write type/value validation codes again here.\n\t\t\tif (options.hasOwnProperty(pN_animationShouldStop)) {\n\t\t\t\tpublicState[pN_animationShouldStop] = options[pN_animationShouldStop];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_animationShouldPause)) {\n\t\t\t\tpublicState[pN_animationShouldPause] = options[pN_animationShouldPause];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_drawingFramesCountLimitation)) {\n\t\t\t\tpublicState[pN_drawingFramesCountLimitation] = options[pN_drawingFramesCountLimitation];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_timeOffsetInSeconds)) {\n\t\t\t\tpublicState[pN_timeOffsetInSeconds] = options[pN_timeOffsetInSeconds];\n\t\t\t}\n\n\t\t\tif (options.hasOwnProperty(pN_bgColor)) {\n\t\t\t\tpublicState[pN_bgColor] = options[pN_bgColor];\n\t\t\t}\n\n\n\t\t\t_inputTemp = options.drawFrame;\n\t\t\tif (typeof _inputTemp === 'function') {\n\t\t\t\tthisInstance.drawFrame = options.drawFrame;\n\t\t\t}\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction getCanvas() {\n\t\t\treturn canvas;\n\t\t}\n\n\t\tfunction getCanvasContext() {\n\t\t\treturn canvasContext;\n\t\t}\n\n\t\tfunction getCanvasContextType() {\n\t\t\treturn canvasContextType;\n\t\t}\n\n\t\tfunction clearCanvas() {\n\t\t\tb_clearCanvas();\n\t\t\treturn b_stopAnimation(); // for chaining method invocations\n\t\t}\n\n\t\tfunction _clearCanvas() {\n\t\t\tcanvasContext.clearRect(0, 0, canvas.width, canvas.height);\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction stopAnimation(shouldClearCanvas) {\n\t\t\tanimationIsStopped = true;\n\t\t\tanimationIsPaused = false;\n\n\t\t\tanimationShouldPause = false;\n\t\t\tanimationShouldStop = false;\n\n\t\t\tif (shouldClearCanvas) b_clearCanvas();\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction startAnimation(newTimeOffset) {\n\t\t\tif (!animationIsPaused && !animationIsStopped) {\n\t\t\t\treturn thisInstance;\n\t\t\t}\n\n\t\t\tanimationIsStopped = false;\n\t\t\tanimationIsPaused = false;\n\n\t\t\tdrawnFramesCount = 0;\n\t\t\tlocalPlayingDurationInSeconds = 0;\n\n\t\t\t// Set twice, if the second value (which is the argument) is invalid and not taken\n\t\t\t// Then the first value (which is zero) takes effects.\n\t\t\tpublicState[pN_timeOffsetInSeconds] = 0;\n\t\t\tpublicState[pN_timeOffsetInSeconds] = newTimeOffset;\n\n\t\t\tanimationStartWallTime = new Date().getTime() - timeOffsetInSeconds;\n\n\t\t\tb_drawNextFrame();\n\n\t\t\t// animationShouldStop = false;\n\t\t\t// animationShouldPause = false;\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction pauseAnimation() {\n\t\t\tif (animationIsStopped || animationIsPaused) return;\n\t\t\tanimationIsPaused = true;\n\t\t\tanimationShouldPause = false;\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction resumeAnimation() {\n\t\t\tif (animationIsStopped || !animationIsPaused) return;\n\n\t\t\tanimationIsPaused = false;\n\t\t\tb_drawNextFrame();\n\n\t\t\treturn thisInstance; // for chaining method invocations\n\t\t}\n\n\t\tfunction _drawNextFrame(/* DOMHighResTimeStamp */) {\n\t\t\t// The \"DOMHighResTimeStamp\" provided by the browser\n\t\t\t// is more accurate but unfortunately NOT what I want.\n\n\t\t\tif (animationIsPaused || animationIsStopped) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (animationShouldStop) {\n\t\t\t\tb_stopAnimation();\n\t\t\t}\n\n\t\t\tif (typeof thisInstance.drawFrame !== 'function') {\n\t\t\t\tconsole.info(\n\t\t\t\t\t'The \"drawFrame\" method is not provided yet.',\n\t\t\t\t\t'Animation will not start.'\n\t\t\t\t);\n\t\t\t\tb_stopAnimation();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdrawnFramesCount++;\n\t\t\tif (drawnFramesCount > drawingFramesCountLimitation) {\n\t\t\t\tconsole.log('Animation frame limitation met. Animation will stop now.');\n\t\t\t\tb_stopAnimation();\n\t\t\t\treturn;\n\t\t\t}\n\n\n\n\t\t\tlocalPlayingDurationInSeconds = (new Date() - animationStartWallTime) / 1000;\n\t\t\tlocalTimeInSeconds = localPlayingDurationInSeconds + timeOffsetInSeconds;\n\n\n\n\n\t\t\tif (animationShouldPause) {\n\t\t\t\tb_pauseAnimation();\n\t\t\t}\n\n\t\t\tb_drawOneFrame();\n\n\t\t\trequestAnimationFrame(b_drawNextFrame);\n\t\t}\n\n\t\tfunction drawOneFrame() {\n\t\t\treturn _drawOneFrameOnTime.call(thisInstance, localTimeInSeconds);\n\t\t}\n\n\t\tfunction drawOneFrameOnTimeViaMethod(localTimeInSeconds) {\n\t\t\t_drawOneFrameOnTime.call(thisInstance, localTimeInSeconds);\n\t\t\treturn pauseAnimation.call(thisInstance); // for chaining method invocations\n\t\t}\n\n\t\tfunction _drawOneFrameOnTime(localTimeInSeconds) {\n\t\t\t_drawOrClearBg.call(thisInstance, localTimeInSeconds)\n\t\t\t\t.drawFrame(canvas, canvasContext, localTimeInSeconds);\n\t\t\treturn thisInstance;\n\t\t}\n\n\t\tfunction _drawOrClearBg() {\n\t\t\tif (bgColor === null || bgColor === '' || bgColor === false) {\n\t\t\t\t_clearCanvas.call(thisInstance);\n\t\t\t} else if (bgColor !== 'transparent') {\n\t\t\t\tcanvasContext.fillStyle = bgColor;\n\t\t\t\tcanvasContext.fillRect(0, 0, canvas.width, canvas.height);\n\t\t\t}\n\n\t\t\treturn thisInstance;\n\t\t}\n\t}\n\n\twlcCanvasAnimationController[pN_isJQueryWrappedObjectOrAlike] = function (object) {\n\t\treturn wlcCanvasAnimationController[pN_isJQueryWrappedObject](object)\n\t\t\t|| object[0] instanceof Node;\n\t};\n\n\twlcCanvasAnimationController[pN_isJQueryWrappedObject] = function (object) {\n\t\treturn !!object.__proto__.jquery;\n\t};\n\n\twlcCanvasAnimationController[pN_isValidColor] = function (color) {\n\t\treturn !!color;\n\t};\n\n\treturn wlcCanvasAnimationController;\n});\n"]}